{"ast":null,"code":"import { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { HttpClient } from '@angular/common/http';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nimport * as i2 from \"@angular/common\";\nimport * as i3 from \"@angular/forms\";\nfunction AppComponent_div_15_button_13_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r3 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 23);\n    i0.ɵɵlistener(\"click\", function AppComponent_div_15_button_13_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r3);\n      const i_r4 = i0.ɵɵnextContext().index;\n      const ctx_r4 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r4.removeInvestor(i_r4));\n    });\n    i0.ɵɵtext(1, \" \\u2715 \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction AppComponent_div_15_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r1 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 17)(1, \"div\", 5)(2, \"span\", 18);\n    i0.ɵɵtext(3, \"\\uD83D\\uDC64\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"input\", 19);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function AppComponent_div_15_Template_input_ngModelChange_4_listener($event) {\n      const investor_r2 = i0.ɵɵrestoreView(_r1).$implicit;\n      i0.ɵɵtwoWayBindingSet(investor_r2.name, $event) || (investor_r2.name = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(5, \"div\", 5)(6, \"span\", 6);\n    i0.ɵɵtext(7, \"$\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"input\", 20);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function AppComponent_div_15_Template_input_ngModelChange_8_listener($event) {\n      const investor_r2 = i0.ɵɵrestoreView(_r1).$implicit;\n      i0.ɵɵtwoWayBindingSet(investor_r2.requestedAmount, $event) || (investor_r2.requestedAmount = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(9, \"div\", 5)(10, \"span\", 6);\n    i0.ɵɵtext(11, \"$\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(12, \"input\", 21);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function AppComponent_div_15_Template_input_ngModelChange_12_listener($event) {\n      const investor_r2 = i0.ɵɵrestoreView(_r1).$implicit;\n      i0.ɵɵtwoWayBindingSet(investor_r2.averageAmount, $event) || (investor_r2.averageAmount = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵtemplate(13, AppComponent_div_15_button_13_Template, 2, 0, \"button\", 22);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const investor_r2 = ctx.$implicit;\n    const i_r4 = ctx.index;\n    const ctx_r4 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(4);\n    i0.ɵɵpropertyInterpolate1(\"name\", \"name-\", i_r4, \"\");\n    i0.ɵɵtwoWayProperty(\"ngModel\", investor_r2.name);\n    i0.ɵɵadvance(4);\n    i0.ɵɵpropertyInterpolate1(\"name\", \"requested-\", i_r4, \"\");\n    i0.ɵɵtwoWayProperty(\"ngModel\", investor_r2.requestedAmount);\n    i0.ɵɵadvance(4);\n    i0.ɵɵpropertyInterpolate1(\"name\", \"average-\", i_r4, \"\");\n    i0.ɵɵtwoWayProperty(\"ngModel\", investor_r2.averageAmount);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ctx_r4.investors.length > 1);\n  }\n}\nfunction AppComponent_div_23_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 24);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r4 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\" \", ctx_r4.error, \" \");\n  }\n}\nfunction AppComponent_div_28_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 25);\n    i0.ɵɵtext(1, \" Results will appear here after you prorate. \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction AppComponent_div_29_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 26);\n    i0.ɵɵtext(1);\n    i0.ɵɵpipe(2, \"currency\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const row_r6 = ctx.$implicit;\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate2(\" \", row_r6.name, \" - \", i0.ɵɵpipeBind4(2, 2, row_r6.amount, \"USD\", \"symbol\", \"1.0-0\"), \" \");\n  }\n}\nexport let AppComponent = /*#__PURE__*/(() => {\n  class AppComponent {\n    constructor(http) {\n      this.http = http;\n      this.title = 'Allocation Proration Tool';\n      this.allocationAmount = 100;\n      this.investors = [{\n        name: 'Investor A',\n        requestedAmount: 100,\n        averageAmount: 95\n      }, {\n        name: 'Investor B',\n        requestedAmount: 2,\n        averageAmount: 1\n      }, {\n        name: 'Investor C',\n        requestedAmount: 1,\n        averageAmount: 4\n      }];\n      this.apiUrl = 'http://localhost:8080/api/allocations/calculate';\n      this.loading = false;\n      this.error = null;\n      this.results = [];\n    }\n    addInvestor() {\n      this.investors.push({\n        name: '',\n        requestedAmount: null,\n        averageAmount: null\n      });\n    }\n    removeInvestor(index) {\n      this.investors.splice(index, 1);\n    }\n    resetToSimpleExample() {\n      this.allocationAmount = 100;\n      this.investors = [{\n        name: 'Investor A',\n        requestedAmount: 100,\n        averageAmount: 100\n      }, {\n        name: 'Investor B',\n        requestedAmount: 25,\n        averageAmount: 25\n      }];\n      this.results = [];\n      this.error = null;\n    }\n    submit() {\n      this.error = null;\n      this.results = [];\n      if (this.allocationAmount == null || this.allocationAmount < 0) {\n        this.error = 'Allocation amount must be a non-negative number.';\n        return;\n      }\n      const cleanedInvestors = this.investors.filter(i => i.name.trim().length > 0);\n      if (cleanedInvestors.length === 0) {\n        this.error = 'Please add at least one investor.';\n        return;\n      }\n      const missing = cleanedInvestors.find(i => i.requestedAmount == null || i.requestedAmount < 0 || i.averageAmount == null || i.averageAmount < 0);\n      if (missing) {\n        this.error = 'Each investor needs a non-negative requested and average amount.';\n        return;\n      }\n      const payload = {\n        allocationAmount: this.allocationAmount,\n        investorAmounts: cleanedInvestors.map(i => ({\n          name: i.name.trim(),\n          requestedAmount: i.requestedAmount,\n          averageAmount: i.averageAmount\n        }))\n      };\n      this.loading = true;\n      this.http.post(this.apiUrl, payload).subscribe({\n        next: data => {\n          this.loading = false;\n          this.results = Object.entries(data).map(([name, amount]) => ({\n            name,\n            amount\n          }));\n        },\n        error: err => {\n          console.error(err);\n          this.loading = false;\n          this.error = 'Something went wrong while calculating. Please ensure the backend is running on port 8080.';\n        }\n      });\n    }\n    static {\n      this.ɵfac = function AppComponent_Factory(t) {\n        return new (t || AppComponent)(i0.ɵɵdirectiveInject(i1.HttpClient));\n      };\n    }\n    static {\n      this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n        type: AppComponent,\n        selectors: [[\"app-root\"]],\n        standalone: true,\n        features: [i0.ɵɵStandaloneFeature],\n        decls: 30,\n        vars: 6,\n        consts: [[1, \"window\"], [1, \"window-bar\"], [1, \"app-shell\", \"layout\"], [1, \"inputs-card\"], [1, \"inputs-inner\"], [1, \"field-row\"], [1, \"prefix\"], [\"type\", \"number\", \"name\", \"allocationAmount\", \"min\", \"0\", \"step\", \"0.000001\", \"placeholder\", \"Allocation\", 3, \"ngModelChange\", \"ngModel\"], [\"class\", \"investor-row\", 4, \"ngFor\", \"ngForOf\"], [1, \"inputs-actions\"], [\"type\", \"button\", 1, \"secondary\", 3, \"click\"], [\"type\", \"button\", 1, \"primary\", 3, \"click\"], [\"class\", \"error\", 4, \"ngIf\"], [1, \"results-card\"], [1, \"results-box\"], [\"class\", \"placeholder\", 4, \"ngIf\"], [\"class\", \"result-line\", 4, \"ngFor\", \"ngForOf\"], [1, \"investor-row\"], [1, \"icon-box\"], [\"type\", \"text\", \"placeholder\", \"Name\", 3, \"ngModelChange\", \"ngModel\", \"name\"], [\"type\", \"number\", \"min\", \"0\", \"step\", \"0.000001\", \"placeholder\", \"Requested Amount\", 3, \"ngModelChange\", \"ngModel\", \"name\"], [\"type\", \"number\", \"min\", \"0\", \"step\", \"0.000001\", \"placeholder\", \"Average Amount\", 3, \"ngModelChange\", \"ngModel\", \"name\"], [\"type\", \"button\", \"class\", \"remove-btn\", 3, \"click\", 4, \"ngIf\"], [\"type\", \"button\", 1, \"remove-btn\", 3, \"click\"], [1, \"error\"], [1, \"placeholder\"], [1, \"result-line\"]],\n        template: function AppComponent_Template(rf, ctx) {\n          if (rf & 1) {\n            i0.ɵɵelementStart(0, \"div\", 0);\n            i0.ɵɵelement(1, \"div\", 1);\n            i0.ɵɵelementStart(2, \"div\", 2)(3, \"div\", 3)(4, \"h2\");\n            i0.ɵɵtext(5, \"Inputs\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(6, \"div\", 4)(7, \"h3\");\n            i0.ɵɵtext(8, \"Total Available Allocation\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(9, \"div\", 5)(10, \"span\", 6);\n            i0.ɵɵtext(11, \"$\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(12, \"input\", 7);\n            i0.ɵɵtwoWayListener(\"ngModelChange\", function AppComponent_Template_input_ngModelChange_12_listener($event) {\n              i0.ɵɵtwoWayBindingSet(ctx.allocationAmount, $event) || (ctx.allocationAmount = $event);\n              return $event;\n            });\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(13, \"h3\");\n            i0.ɵɵtext(14, \"Investor Breakdown\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵtemplate(15, AppComponent_div_15_Template, 14, 10, \"div\", 8);\n            i0.ɵɵelementStart(16, \"div\", 9)(17, \"button\", 10);\n            i0.ɵɵlistener(\"click\", function AppComponent_Template_button_click_17_listener() {\n              return ctx.addInvestor();\n            });\n            i0.ɵɵtext(18, \" + Add row \");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(19, \"button\", 10);\n            i0.ɵɵlistener(\"click\", function AppComponent_Template_button_click_19_listener() {\n              return ctx.resetToSimpleExample();\n            });\n            i0.ɵɵtext(20, \" Load sample \");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(21, \"button\", 11);\n            i0.ɵɵlistener(\"click\", function AppComponent_Template_button_click_21_listener() {\n              return ctx.submit();\n            });\n            i0.ɵɵtext(22);\n            i0.ɵɵelementEnd()();\n            i0.ɵɵtemplate(23, AppComponent_div_23_Template, 2, 1, \"div\", 12);\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(24, \"div\", 13)(25, \"h2\");\n            i0.ɵɵtext(26, \"Results\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(27, \"div\", 14);\n            i0.ɵɵtemplate(28, AppComponent_div_28_Template, 2, 0, \"div\", 15)(29, AppComponent_div_29_Template, 3, 7, \"div\", 16);\n            i0.ɵɵelementEnd()()()();\n          }\n          if (rf & 2) {\n            i0.ɵɵadvance(12);\n            i0.ɵɵtwoWayProperty(\"ngModel\", ctx.allocationAmount);\n            i0.ɵɵadvance(3);\n            i0.ɵɵproperty(\"ngForOf\", ctx.investors);\n            i0.ɵɵadvance(7);\n            i0.ɵɵtextInterpolate1(\" \", ctx.loading ? \"Prorating\\u2026\" : \"Prorate\", \" \");\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", ctx.error);\n            i0.ɵɵadvance(5);\n            i0.ɵɵproperty(\"ngIf\", !ctx.results.length);\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngForOf\", ctx.results);\n          }\n        },\n        dependencies: [CommonModule, i2.NgForOf, i2.NgIf, i2.CurrencyPipe, FormsModule, i3.DefaultValueAccessor, i3.NumberValueAccessor, i3.NgControlStatus, i3.MinValidator, i3.NgModel],\n        styles: [\"[_nghost-%COMP%]{display:block}\"]\n      });\n    }\n  }\n  return AppComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}