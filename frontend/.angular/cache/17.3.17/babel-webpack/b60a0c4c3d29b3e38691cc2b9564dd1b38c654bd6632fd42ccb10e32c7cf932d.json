{"ast":null,"code":"import { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { HttpClient } from '@angular/common/http';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nimport * as i2 from \"@angular/common\";\nimport * as i3 from \"@angular/forms\";\nfunction AppComponent_div_17_button_4_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r3 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 16);\n    i0.ɵɵlistener(\"click\", function AppComponent_div_17_button_4_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r3);\n      const i_r4 = i0.ɵɵnextContext().index;\n      const ctx_r4 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r4.removeInvestor(i_r4));\n    });\n    i0.ɵɵtext(1, \" \\u2715 \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction AppComponent_div_17_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r1 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 12)(1, \"input\", 13);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function AppComponent_div_17_Template_input_ngModelChange_1_listener($event) {\n      const investor_r2 = i0.ɵɵrestoreView(_r1).$implicit;\n      i0.ɵɵtwoWayBindingSet(investor_r2.name, $event) || (investor_r2.name = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(2, \"input\", 14);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function AppComponent_div_17_Template_input_ngModelChange_2_listener($event) {\n      const investor_r2 = i0.ɵɵrestoreView(_r1).$implicit;\n      i0.ɵɵtwoWayBindingSet(investor_r2.requestedAmount, $event) || (investor_r2.requestedAmount = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"input\", 14);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function AppComponent_div_17_Template_input_ngModelChange_3_listener($event) {\n      const investor_r2 = i0.ɵɵrestoreView(_r1).$implicit;\n      i0.ɵɵtwoWayBindingSet(investor_r2.averageAmount, $event) || (investor_r2.averageAmount = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(4, AppComponent_div_17_button_4_Template, 2, 0, \"button\", 15);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const investor_r2 = ctx.$implicit;\n    const i_r4 = ctx.index;\n    const ctx_r4 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵpropertyInterpolate1(\"name\", \"name-\", i_r4, \"\");\n    i0.ɵɵpropertyInterpolate1(\"placeholder\", \"Investor \", i_r4 + 1, \"\");\n    i0.ɵɵtwoWayProperty(\"ngModel\", investor_r2.name);\n    i0.ɵɵadvance();\n    i0.ɵɵpropertyInterpolate1(\"name\", \"requested-\", i_r4, \"\");\n    i0.ɵɵtwoWayProperty(\"ngModel\", investor_r2.requestedAmount);\n    i0.ɵɵadvance();\n    i0.ɵɵpropertyInterpolate1(\"name\", \"average-\", i_r4, \"\");\n    i0.ɵɵtwoWayProperty(\"ngModel\", investor_r2.averageAmount);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ctx_r4.investors.length > 1);\n  }\n}\nfunction AppComponent_div_25_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 17);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r4 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\" \", ctx_r4.error, \" \");\n  }\n}\nfunction AppComponent_div_26_tr_11_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4);\n    i0.ɵɵpipe(5, \"number\");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const row_r6 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(row_r6.name);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(5, 2, row_r6.amount, \"1.2-6\"));\n  }\n}\nfunction AppComponent_div_26_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 18)(1, \"h2\");\n    i0.ɵɵtext(2, \"Final allocation\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"table\", 19)(4, \"thead\")(5, \"tr\")(6, \"th\");\n    i0.ɵɵtext(7, \"Investor\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"th\");\n    i0.ɵɵtext(9, \"Final amount\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(10, \"tbody\");\n    i0.ɵɵtemplate(11, AppComponent_div_26_tr_11_Template, 6, 5, \"tr\", 20);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const ctx_r4 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(11);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r4.results);\n  }\n}\nexport let AppComponent = /*#__PURE__*/(() => {\n  class AppComponent {\n    constructor(http) {\n      this.http = http;\n      this.title = 'Allocation Proration Tool';\n      this.allocationAmount = 100;\n      this.investors = [{\n        name: 'Investor A',\n        requestedAmount: 100,\n        averageAmount: 95\n      }, {\n        name: 'Investor B',\n        requestedAmount: 2,\n        averageAmount: 1\n      }, {\n        name: 'Investor C',\n        requestedAmount: 1,\n        averageAmount: 4\n      }];\n      this.apiUrl = 'http://localhost:8080/api/allocations/calculate';\n      this.loading = false;\n      this.error = null;\n      this.results = [];\n    }\n    addInvestor() {\n      this.investors.push({\n        name: '',\n        requestedAmount: null,\n        averageAmount: null\n      });\n    }\n    removeInvestor(index) {\n      this.investors.splice(index, 1);\n    }\n    resetToSimpleExample() {\n      this.allocationAmount = 100;\n      this.investors = [{\n        name: 'Investor A',\n        requestedAmount: 100,\n        averageAmount: 100\n      }, {\n        name: 'Investor B',\n        requestedAmount: 25,\n        averageAmount: 25\n      }];\n      this.results = [];\n      this.error = null;\n    }\n    submit() {\n      this.error = null;\n      this.results = [];\n      if (this.allocationAmount == null || this.allocationAmount < 0) {\n        this.error = 'Allocation amount must be a non-negative number.';\n        return;\n      }\n      const cleanedInvestors = this.investors.filter(i => i.name.trim().length > 0);\n      if (cleanedInvestors.length === 0) {\n        this.error = 'Please add at least one investor.';\n        return;\n      }\n      const missing = cleanedInvestors.find(i => i.requestedAmount == null || i.requestedAmount < 0 || i.averageAmount == null || i.averageAmount < 0);\n      if (missing) {\n        this.error = 'Each investor needs a non-negative requested and average amount.';\n        return;\n      }\n      const payload = {\n        allocationAmount: this.allocationAmount,\n        investorAmounts: cleanedInvestors.map(i => ({\n          name: i.name.trim(),\n          requestedAmount: i.requestedAmount,\n          averageAmount: i.averageAmount\n        }))\n      };\n      this.loading = true;\n      this.http.post(this.apiUrl, payload).subscribe({\n        next: data => {\n          this.loading = false;\n          this.results = Object.entries(data).map(([name, amount]) => ({\n            name,\n            amount\n          }));\n        },\n        error: err => {\n          console.error(err);\n          this.loading = false;\n          this.error = 'Something went wrong while calculating. Please ensure the backend is running on port 8080.';\n        }\n      });\n    }\n    static {\n      this.ɵfac = function AppComponent_Factory(t) {\n        return new (t || AppComponent)(i0.ɵɵdirectiveInject(i1.HttpClient));\n      };\n    }\n    static {\n      this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n        type: AppComponent,\n        selectors: [[\"app-root\"]],\n        standalone: true,\n        features: [i0.ɵɵStandaloneFeature],\n        decls: 27,\n        vars: 6,\n        consts: [[1, \"app-shell\"], [1, \"subtitle\"], [1, \"form-row\"], [\"for\", \"allocation\"], [\"id\", \"allocation\", \"type\", \"number\", \"name\", \"allocationAmount\", \"min\", \"0\", \"step\", \"0.000001\", 3, \"ngModelChange\", \"ngModel\"], [1, \"table-header\"], [\"class\", \"table-row\", 4, \"ngFor\", \"ngForOf\"], [1, \"actions\"], [\"type\", \"button\", 1, \"secondary\", 3, \"click\"], [\"type\", \"button\", 1, \"primary\", 3, \"click\"], [\"style\", \"color: #b91c1c; margin-top: 12px;\", 4, \"ngIf\"], [\"class\", \"results-card\", 4, \"ngIf\"], [1, \"table-row\"], [\"type\", \"text\", 3, \"ngModelChange\", \"ngModel\", \"name\", \"placeholder\"], [\"type\", \"number\", \"min\", \"0\", \"step\", \"0.000001\", 3, \"ngModelChange\", \"ngModel\", \"name\"], [\"type\", \"button\", \"class\", \"danger\", 3, \"click\", 4, \"ngIf\"], [\"type\", \"button\", 1, \"danger\", 3, \"click\"], [2, \"color\", \"#b91c1c\", \"margin-top\", \"12px\"], [1, \"results-card\"], [1, \"results-table\"], [4, \"ngFor\", \"ngForOf\"]],\n        template: function AppComponent_Template(rf, ctx) {\n          if (rf & 1) {\n            i0.ɵɵelementStart(0, \"div\", 0)(1, \"h1\");\n            i0.ɵɵtext(2);\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(3, \"p\", 1);\n            i0.ɵɵtext(4, \" Enter the total allocation and investor requests. The tool will apply the same proration logic as in the sample JSON files. \");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(5, \"div\", 2)(6, \"label\", 3);\n            i0.ɵɵtext(7, \"Total allocation\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(8, \"input\", 4);\n            i0.ɵɵtwoWayListener(\"ngModelChange\", function AppComponent_Template_input_ngModelChange_8_listener($event) {\n              i0.ɵɵtwoWayBindingSet(ctx.allocationAmount, $event) || (ctx.allocationAmount = $event);\n              return $event;\n            });\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(9, \"div\", 5)(10, \"div\");\n            i0.ɵɵtext(11, \"Investor name\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(12, \"div\");\n            i0.ɵɵtext(13, \"Requested\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(14, \"div\");\n            i0.ɵɵtext(15, \"Average\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelement(16, \"div\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵtemplate(17, AppComponent_div_17_Template, 5, 12, \"div\", 6);\n            i0.ɵɵelementStart(18, \"div\", 7)(19, \"button\", 8);\n            i0.ɵɵlistener(\"click\", function AppComponent_Template_button_click_19_listener() {\n              return ctx.addInvestor();\n            });\n            i0.ɵɵtext(20, \" + Add investor \");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(21, \"button\", 8);\n            i0.ɵɵlistener(\"click\", function AppComponent_Template_button_click_21_listener() {\n              return ctx.resetToSimpleExample();\n            });\n            i0.ɵɵtext(22, \" Load sample (simple 1) \");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(23, \"button\", 9);\n            i0.ɵɵlistener(\"click\", function AppComponent_Template_button_click_23_listener() {\n              return ctx.submit();\n            });\n            i0.ɵɵtext(24);\n            i0.ɵɵelementEnd()();\n            i0.ɵɵtemplate(25, AppComponent_div_25_Template, 2, 1, \"div\", 10)(26, AppComponent_div_26_Template, 12, 1, \"div\", 11);\n            i0.ɵɵelementEnd();\n          }\n          if (rf & 2) {\n            i0.ɵɵadvance(2);\n            i0.ɵɵtextInterpolate(ctx.title);\n            i0.ɵɵadvance(6);\n            i0.ɵɵtwoWayProperty(\"ngModel\", ctx.allocationAmount);\n            i0.ɵɵadvance(9);\n            i0.ɵɵproperty(\"ngForOf\", ctx.investors);\n            i0.ɵɵadvance(7);\n            i0.ɵɵtextInterpolate1(\" \", ctx.loading ? \"Calculating\\u2026\" : \"Calculate allocation\", \" \");\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", ctx.error);\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", ctx.results.length);\n          }\n        },\n        dependencies: [CommonModule, i2.NgForOf, i2.NgIf, i2.DecimalPipe, FormsModule, i3.DefaultValueAccessor, i3.NumberValueAccessor, i3.NgControlStatus, i3.MinValidator, i3.NgModel],\n        styles: [\"[_nghost-%COMP%]{display:block}\"]\n      });\n    }\n  }\n  return AppComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}