{"ast":null,"code":"import { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { HttpClient } from '@angular/common/http';\nimport { MatIconModule } from '@angular/material/icon';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nimport * as i2 from \"@angular/common\";\nimport * as i3 from \"@angular/forms\";\nimport * as i4 from \"@angular/material/icon\";\nfunction AppComponent_div_14_button_14_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r3 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 23);\n    i0.ɵɵlistener(\"click\", function AppComponent_div_14_button_14_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r3);\n      const i_r4 = i0.ɵɵnextContext().index;\n      const ctx_r4 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r4.removeInvestor(i_r4));\n    });\n    i0.ɵɵelementStart(1, \"mat-icon\", 24);\n    i0.ɵɵtext(2, \"delete\");\n    i0.ɵɵelementEnd()();\n  }\n}\nfunction AppComponent_div_14_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r1 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 17)(1, \"div\", 4)(2, \"span\", 18)(3, \"mat-icon\");\n    i0.ɵɵtext(4, \"person\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(5, \"input\", 19);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function AppComponent_div_14_Template_input_ngModelChange_5_listener($event) {\n      const investor_r2 = i0.ɵɵrestoreView(_r1).$implicit;\n      i0.ɵɵtwoWayBindingSet(investor_r2.name, $event) || (investor_r2.name = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(6, \"div\", 4)(7, \"span\", 5);\n    i0.ɵɵtext(8, \"$\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"input\", 20);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function AppComponent_div_14_Template_input_ngModelChange_9_listener($event) {\n      const investor_r2 = i0.ɵɵrestoreView(_r1).$implicit;\n      i0.ɵɵtwoWayBindingSet(investor_r2.requestedAmount, $event) || (investor_r2.requestedAmount = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(10, \"div\", 4)(11, \"span\", 5);\n    i0.ɵɵtext(12, \"$\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(13, \"input\", 21);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function AppComponent_div_14_Template_input_ngModelChange_13_listener($event) {\n      const investor_r2 = i0.ɵɵrestoreView(_r1).$implicit;\n      i0.ɵɵtwoWayBindingSet(investor_r2.averageAmount, $event) || (investor_r2.averageAmount = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵtemplate(14, AppComponent_div_14_button_14_Template, 3, 0, \"button\", 22);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const investor_r2 = ctx.$implicit;\n    const i_r4 = ctx.index;\n    const ctx_r4 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(5);\n    i0.ɵɵpropertyInterpolate1(\"name\", \"name-\", i_r4, \"\");\n    i0.ɵɵtwoWayProperty(\"ngModel\", investor_r2.name);\n    i0.ɵɵadvance(4);\n    i0.ɵɵpropertyInterpolate1(\"name\", \"requested-\", i_r4, \"\");\n    i0.ɵɵtwoWayProperty(\"ngModel\", investor_r2.requestedAmount);\n    i0.ɵɵadvance(4);\n    i0.ɵɵpropertyInterpolate1(\"name\", \"average-\", i_r4, \"\");\n    i0.ɵɵtwoWayProperty(\"ngModel\", investor_r2.averageAmount);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ctx_r4.investors.length > 1);\n  }\n}\nfunction AppComponent_div_25_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 25);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r4 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\" \", ctx_r4.error, \" \");\n  }\n}\nfunction AppComponent_div_30_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 26);\n    i0.ɵɵtext(1, \" Results will appear here after you prorate. \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction AppComponent_div_31_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 27);\n    i0.ɵɵtext(1);\n    i0.ɵɵpipe(2, \"currency\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const row_r6 = ctx.$implicit;\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate2(\" \", row_r6.name, \" - \", i0.ɵɵpipeBind4(2, 2, row_r6.amount, \"USD\", \"symbol\", \"1.2-5\"), \" \");\n  }\n}\nexport let AppComponent = /*#__PURE__*/(() => {\n  class AppComponent {\n    constructor(http) {\n      this.http = http;\n      this.title = 'Allocation Proration Tool';\n      // It is the default starting allocation and investors\n      this.allocationAmount = 100;\n      this.investors = [{\n        name: 'Investor A',\n        requestedAmount: 100,\n        averageAmount: 95\n      }, {\n        name: 'Investor B',\n        requestedAmount: 2,\n        averageAmount: 1\n      }, {\n        name: 'Investor C',\n        requestedAmount: 1,\n        averageAmount: 4\n      }];\n      // This is Backend Calculation API \n      this.apiUrl = 'http://localhost:8080/api/allocations/calculate';\n      this.loading = false;\n      this.error = null;\n      // It stores result that is returned from backend\n      this.results = [];\n    }\n    // method is used to add a new blank investor entry\n    addInvestor() {\n      this.investors.push({\n        name: '',\n        requestedAmount: null,\n        averageAmount: null\n      });\n    }\n    // method for removing investor\n    removeInvestor(index) {\n      this.investors.splice(index, 1);\n    }\n    // this is method that will reset to simple defined example\n    resetToDefault() {\n      this.allocationAmount = 100;\n      this.investors = [{\n        name: 'Investor A',\n        requestedAmount: 100,\n        averageAmount: 100\n      }, {\n        name: 'Investor B',\n        requestedAmount: 25,\n        averageAmount: 25\n      }];\n      this.results = [];\n      this.error = null;\n    }\n    // this method will validate and submit the data from frontend to backend API\n    submit() {\n      this.error = null;\n      this.results = [];\n      // checks either allocation amount is null or negative\n      if (this.allocationAmount == null || this.allocationAmount < 0) {\n        this.error = 'Allocation amount must be postive number.';\n        return;\n      }\n      // this remove the empty investor entries\n      const cleanedInvestors = this.investors.filter(i => i.name.trim().length > 0);\n      if (cleanedInvestors.length === 0) {\n        this.error = 'Please add at least one investor.';\n        return;\n      }\n      // this part ensure all fields are valid and not negative\n      const missing = cleanedInvestors.find(i => i.requestedAmount == null || i.requestedAmount < 0 || i.averageAmount == null || i.averageAmount < 0);\n      if (missing) {\n        this.error = 'Each investor needs positive requested and average amount.';\n        return;\n      }\n      // here prepare payload for API\n      const payload = {\n        allocationAmount: this.allocationAmount,\n        investorAmounts: cleanedInvestors.map(i => ({\n          name: i.name.trim(),\n          requestedAmount: i.requestedAmount,\n          averageAmount: i.averageAmount\n        }))\n      };\n      this.loading = true;\n      // this will send post request to backend\n      this.http.post(this.apiUrl, payload).subscribe({\n        next: data => {\n          this.loading = false;\n          // this will convert plain object response into array formt for UI\n          this.results = Object.entries(data).map(([name, amount]) => ({\n            name,\n            amount\n          }));\n        },\n        // it will throw error if any error is caught\n        error: err => {\n          console.error(err);\n          this.loading = false;\n          this.error = 'Something went wrong while calculating.';\n        }\n      });\n    }\n    static {\n      this.ɵfac = function AppComponent_Factory(t) {\n        return new (t || AppComponent)(i0.ɵɵdirectiveInject(i1.HttpClient));\n      };\n    }\n    static {\n      this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n        type: AppComponent,\n        selectors: [[\"app-root\"]],\n        standalone: true,\n        features: [i0.ɵɵStandaloneFeature],\n        decls: 32,\n        vars: 6,\n        consts: [[1, \"window\"], [1, \"app-shell\", \"layout\"], [1, \"inputs-card\"], [1, \"inputs-inner\"], [1, \"field-row\"], [1, \"prefix\"], [\"type\", \"number\", \"name\", \"allocationAmount\", \"min\", \"0\", \"step\", \"0.000001\", \"placeholder\", \"Allocation\", 3, \"ngModelChange\", \"ngModel\"], [\"class\", \"investor-row\", 4, \"ngFor\", \"ngForOf\"], [1, \"inputs-actions\"], [\"type\", \"button\", 1, \"secondary\", 3, \"click\"], [\"color\", \"primary\"], [\"type\", \"button\", 1, \"primary\", 3, \"click\"], [\"class\", \"error\", 4, \"ngIf\"], [1, \"results-card\"], [1, \"results-box\"], [\"class\", \"placeholder\", 4, \"ngIf\"], [\"class\", \"result-line\", 4, \"ngFor\", \"ngForOf\"], [1, \"investor-row\"], [1, \"icon-box\"], [\"type\", \"text\", \"placeholder\", \"Name\", 3, \"ngModelChange\", \"ngModel\", \"name\"], [\"type\", \"number\", \"min\", \"0\", \"step\", \"0.000001\", \"placeholder\", \"Requested Amount\", 3, \"ngModelChange\", \"ngModel\", \"name\"], [\"type\", \"number\", \"min\", \"0\", \"step\", \"0.000001\", \"placeholder\", \"Average Amount\", 3, \"ngModelChange\", \"ngModel\", \"name\"], [\"type\", \"button\", \"class\", \"remove-btn\", 3, \"click\", 4, \"ngIf\"], [\"type\", \"button\", 1, \"remove-btn\", 3, \"click\"], [\"color\", \"warn\"], [1, \"error\"], [1, \"placeholder\"], [1, \"result-line\"]],\n        template: function AppComponent_Template(rf, ctx) {\n          if (rf & 1) {\n            i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"div\", 2)(3, \"h2\");\n            i0.ɵɵtext(4, \"Inputs\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(5, \"div\", 3)(6, \"h3\");\n            i0.ɵɵtext(7, \"Total Available Allocation\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(8, \"div\", 4)(9, \"span\", 5);\n            i0.ɵɵtext(10, \"$\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(11, \"input\", 6);\n            i0.ɵɵtwoWayListener(\"ngModelChange\", function AppComponent_Template_input_ngModelChange_11_listener($event) {\n              i0.ɵɵtwoWayBindingSet(ctx.allocationAmount, $event) || (ctx.allocationAmount = $event);\n              return $event;\n            });\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(12, \"h3\");\n            i0.ɵɵtext(13, \"Investor Breakdown\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵtemplate(14, AppComponent_div_14_Template, 15, 10, \"div\", 7);\n            i0.ɵɵelementStart(15, \"div\", 8)(16, \"button\", 9);\n            i0.ɵɵlistener(\"click\", function AppComponent_Template_button_click_16_listener() {\n              return ctx.addInvestor();\n            });\n            i0.ɵɵtext(17, \" +\");\n            i0.ɵɵelementStart(18, \"mat-icon\", 10);\n            i0.ɵɵtext(19, \"add\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵtext(20, \" Add row \");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(21, \"button\", 9);\n            i0.ɵɵlistener(\"click\", function AppComponent_Template_button_click_21_listener() {\n              return ctx.resetToDefault();\n            });\n            i0.ɵɵtext(22, \" Load sample \");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(23, \"button\", 11);\n            i0.ɵɵlistener(\"click\", function AppComponent_Template_button_click_23_listener() {\n              return ctx.submit();\n            });\n            i0.ɵɵtext(24);\n            i0.ɵɵelementEnd()();\n            i0.ɵɵtemplate(25, AppComponent_div_25_Template, 2, 1, \"div\", 12);\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(26, \"div\", 13)(27, \"h2\");\n            i0.ɵɵtext(28, \"Results\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(29, \"div\", 14);\n            i0.ɵɵtemplate(30, AppComponent_div_30_Template, 2, 0, \"div\", 15)(31, AppComponent_div_31_Template, 3, 7, \"div\", 16);\n            i0.ɵɵelementEnd()()()();\n          }\n          if (rf & 2) {\n            i0.ɵɵadvance(11);\n            i0.ɵɵtwoWayProperty(\"ngModel\", ctx.allocationAmount);\n            i0.ɵɵadvance(3);\n            i0.ɵɵproperty(\"ngForOf\", ctx.investors);\n            i0.ɵɵadvance(10);\n            i0.ɵɵtextInterpolate1(\" \", ctx.loading ? \"Prorating\\u2026\" : \"Prorate\", \" \");\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", ctx.error);\n            i0.ɵɵadvance(5);\n            i0.ɵɵproperty(\"ngIf\", !ctx.results.length);\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngForOf\", ctx.results);\n          }\n        },\n        dependencies: [CommonModule, i2.NgForOf, i2.NgIf, i2.CurrencyPipe, FormsModule, i3.DefaultValueAccessor, i3.NumberValueAccessor, i3.NgControlStatus, i3.MinValidator, i3.NgModel, MatIconModule, i4.MatIcon],\n        styles: [\"[_nghost-%COMP%]{display:block}\"]\n      });\n    }\n  }\n  return AppComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}